import pandas as pd

# 예제 데이터프레임 (Profit 값만 존재)
data = {
    "Profit": [
        -7138768,
        -12885721,
        -19714803,
        -29645731,
        1185467,
        1111819,
        905929,
        -2984359,
        996352,
        996352,
        5079476,
        5079476,
        -3504,
        355112,
        2198125,
        1393055,
        482079,
        439420,
        2446991,
        2419889,
        2016168,
        3492087,
        6900287,
        7716006686473,
        4114204,
        7410956,
        12556421,
        14640831,
        2701690,
        5342217,
        10205240,
        13499994,
        1662926,
        3015637,
        6316851,
        7711931,
        1099413,
        451211,
        2513892,
        3442156,
        962250,
        962250,
        962250,
        962250,
        450323,
        450323,
        450323,
        450323,
        3239209,
        3239209,
        3239209,
        3239209,
        3259478,
        3259478,
        3259478,
        3259478,
        -1058371,
        -1058371,
        -1058371,
        -1058371,
        4431853,
        4431853,
        4431853,
        4431853,
        4971104,
        4971104,
        4971104,
        4971104,
        5440325,
        5440325,
        5440325,
        5440325,
        5761596,
        5761596,
        5761596,
        5761596,
    ]
}  # 10개 값
profit_df = pd.DataFrame(data)

# 필요한 행 개수
num_rows = len(profit_df)

# Year 및 Quarter 컬럼 생성
start_year = 2022
years = []
remaining_rows = num_rows

while remaining_rows > 0:
    repeat_count = min(4, remaining_rows)  # 최대 4번 반복, 데이터 개수 초과 방지
    years.extend([start_year] * repeat_count)
    start_year -= 1
    remaining_rows -= repeat_count

quarters = [1, 2, 3, 4] * (num_rows // 4 + 1)
quarters = quarters[:num_rows]  # 데이터 길이에 맞춤

profit_df["Year"] = years
profit_df["Quarter"] = quarters

# 데이터프레임 크기 확인
print(profit_df.shape)  # (76, 3)
print(profit_df)
